import{f,u as w,o as N,d as C,j as e,e as b,g as I,h as U,i as O,k as P,l as z,m as A,n as H,T as M,I as V,p as R,q as B,C as D,r as v,B as $,c as J}from"../../../assets/js/Newtab.nHRDOKhO.js";import{r as S,R as k,s as K,o as g,b as G}from"../../../assets/js/cache-images.iaijA35r.js";function Q(a){const t=Object.assign({},a);for(let n in t)t[n]===void 0&&delete t[n];return t}function W(a){return S.Children.toArray(a).filter(t=>S.isValidElement(t))}var h=f(function(t,n){var s;const o=w("FormLabel",t),l=N(t),{className:d,children:u,requiredIndicator:i=e.jsx(L,{}),optionalIndicator:m=null,...r}=l,p=C(),c=(s=p==null?void 0:p.getLabelProps(r,n))!=null?s:{ref:n,...r};return e.jsxs(b.label,{...c,className:I("chakra-form__label",l.className),__css:{display:"block",textAlign:"start",...o},children:[u,p!=null&&p.isRequired?i:m]})});h.displayName="FormLabel";var L=f(function(t,n){const s=C(),o=U();if(!(s!=null&&s.isRequired))return null;const l=I("chakra-form__required-indicator",t.className);return e.jsx(b.span,{...s==null?void 0:s.getRequiredIndicatorProps(t,n),__css:o.requiredIndicator,className:l})});L.displayName="RequiredIndicator";var[X,Y]=O({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),q=f(function(t,n){const s=P("Input",t),{children:o,className:l,...d}=N(t),u=I("chakra-input__group",l),i={},m=W(o),r=s.field;m.forEach(c=>{var x,y;s&&(r&&c.type.id==="InputLeftElement"&&(i.paddingStart=(x=r.height)!=null?x:r.h),r&&c.type.id==="InputRightElement"&&(i.paddingEnd=(y=r.height)!=null?y:r.h),c.type.id==="InputRightAddon"&&(i.borderEndRadius=0),c.type.id==="InputLeftAddon"&&(i.borderStartRadius=0))});const p=m.map(c=>{var x,y;const E=Q({size:((x=c.props)==null?void 0:x.size)||t.size,variant:((y=c.props)==null?void 0:y.variant)||t.variant});return c.type.id!=="Input"?S.cloneElement(c,E):S.cloneElement(c,Object.assign(E,i,c.props))});return e.jsx(b.div,{className:u,ref:n,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate",...s.group},"data-group":!0,...d,children:e.jsx(X,{value:s,children:p})})});q.displayName="InputGroup";var Z=b("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),j=f(function(t,n){var s,o;const{placement:l="left",...d}=t,u=Y(),i=u.field,r={[l==="left"?"insetStart":"insetEnd"]:"0",width:(s=i==null?void 0:i.height)!=null?s:i==null?void 0:i.h,height:(o=i==null?void 0:i.height)!=null?o:i==null?void 0:i.h,fontSize:i==null?void 0:i.fontSize,...u.element};return e.jsx(Z,{ref:n,__css:r,...d})});j.id="InputElement";j.displayName="InputElement";var F=f(function(t,n){const{className:s,...o}=t,l=I("chakra-input__left-element",s);return e.jsx(j,{ref:n,placement:"left",className:l,...o})});F.id="InputLeftElement";F.displayName="InputLeftElement";var _=f(function(t,n){const{className:s,...o}=t,l=I("chakra-input__right-element",s);return e.jsx(j,{ref:n,placement:"right",className:l,...o})});_.id="InputRightElement";_.displayName="InputRightElement";function ee(a,t=[]){const n=Object.assign({},a);for(const s of t)s in n&&delete n[s];return n}var te=["h","minH","height","minHeight"],T=f((a,t)=>{const n=w("Textarea",a),{className:s,rows:o,...l}=N(a),d=z(l),u=o?ee(n,te):n;return e.jsx(b.textarea,{ref:t,rows:o,...d,className:I("chakra-textarea",s),__css:u})});T.displayName="Textarea";const ne=()=>{const a=k.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:a,type:"file",accept:"application/json",className:"hidden",onChange:t=>{var s;console.log("click",t);const n=(s=t.currentTarget.files)==null?void 0:s[0];if(n){const o=new FileReader;o.onload=function(l){var u;const d=(u=l.target)==null?void 0:u.result;if(d){const i=JSON.parse(d),m=Object.keys(i).sort(),r=["groupsMap","groupsSort","selectedGroupId","allSpacesMap"];m.filter(p=>r.includes(p)).length===r.length?(A.setState(p=>({...p,...i})),K.set(i)):H.confirm({title:"Upload Error",content:"The file is not a valid backup file",onOk:()=>{}})}},o.readAsText(n)}}}),e.jsx(M,{label:"上传备份文件",children:e.jsx(V,{"aria-label":"Save",icon:e.jsx(R,{icon:"ic:round-upload-file",width:"24",height:"24"}),onClick:()=>{var t;(t=a.current)==null||t.click()}})})]})},se=a=>e.jsx(R,{inline:!0,icon:"mdi:github",width:"20",height:"20",className:"cursor-pointer",onClick:a.onClick}),ae=()=>{var d,u,i;const[a,t]=k.useState(!1),{register:n,handleSubmit:s,watch:o,setValue:l}=B({defaultValues:{syncGistId:g.getSnapshot().syncGistId,token:g.getSnapshot().token,backupGistId:g.getSnapshot().backupGistId,githubUsername:(d=g.getSnapshot())==null?void 0:d.githubUsername,faviconSyncList:(u=g.getSnapshot())==null?void 0:u.faviconSyncList,deviceId:(i=G.getSnapshot())==null?void 0:i.deviceId}});return k.useEffect(()=>{const m=o((r,{name:p,type:c})=>{c==="change"&&(g.set({gistId:r.backupGistId,backupGistId:r.backupGistId,syncGistId:r.syncGistId,token:r.token,githubUsername:r.githubUsername,faviconSyncList:r.faviconSyncList}),G.set({deviceId:r.deviceId}))});return()=>m.unsubscribe()},[o]),e.jsx(D,{children:e.jsxs("div",{className:"m-12 max-w-lg",children:[e.jsx(h,{children:"GitHub Username"}),e.jsx(v,{...n("githubUsername"),className:"mb-6"}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{children:"Sync Gist ID"}),e.jsx(se,{onClick:()=>{window.open(`https://gist.github.com/${o("githubUsername")}/${o("syncGistId")}`,"_blank")}})]})}),e.jsx(v,{...n("syncGistId"),className:"mb-6"}),e.jsx(h,{children:"Gist Token"}),e.jsxs(q,{children:[e.jsx(v,{...n("token"),className:"mb-6",type:a?"text":"password"}),e.jsx(_,{width:"4.5rem",children:e.jsx($,{h:"1.75rem",size:"sm",onClick:()=>{t(!a)},children:a?"Hide":"Show"})})]}),e.jsx(h,{children:"Device Id"}),e.jsx(v,{...n("deviceId"),className:"mb-6"}),e.jsx(h,{children:"Favicon Sync List"}),e.jsx(T,{...n("faviconSyncList"),className:"mb-6"}),e.jsx(h,{children:"Other Actions"}),e.jsx(ne,{})]})})};function ie(){const a=document.querySelector("#app-container");if(!a)throw new Error("Can not find #app-container");J(a).render(e.jsx(ae,{}))}ie();
