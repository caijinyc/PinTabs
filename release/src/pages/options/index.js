import{f as b,u as y,o as S,d as v,j as e,e as j,g as I,h as C,i as R,k as L,l as _,T as q,I as F,m as N,n as T,C as U,p as x,q as P,r as O,B as E,c as H}from"../../../assets/js/Newtab.oXniw8Rh.js";import{R as g,s as A,o as h,b as k}from"../../../assets/js/cache-images.iaijA35r.js";var m=b(function(n,s){var a;const o=y("FormLabel",n),r=S(n),{className:d,children:c,requiredIndicator:u=e.jsx(w,{}),optionalIndicator:p=null,...i}=r,l=v(),f=(a=l==null?void 0:l.getLabelProps(i,s))!=null?a:{ref:s,...i};return e.jsxs(j.label,{...f,className:I("chakra-form__label",r.className),__css:{display:"block",textAlign:"start",...o},children:[c,l!=null&&l.isRequired?u:p]})});m.displayName="FormLabel";var w=b(function(n,s){const a=v(),o=C();if(!(a!=null&&a.isRequired))return null;const r=I("chakra-form__required-indicator",n.className);return e.jsx(j.span,{...a==null?void 0:a.getRequiredIndicatorProps(n,s),__css:o.requiredIndicator,className:r})});w.displayName="RequiredIndicator";function B(t,n=[]){const s=Object.assign({},t);for(const a of n)a in s&&delete s[a];return s}var D=["h","minH","height","minHeight"],G=b((t,n)=>{const s=y("Textarea",t),{className:a,rows:o,...r}=S(t),d=R(r),c=o?B(s,D):s;return e.jsx(j.textarea,{ref:n,rows:o,...d,className:I("chakra-textarea",a),__css:c})});G.displayName="Textarea";const M=()=>{const t=g.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:t,type:"file",accept:"application/json",className:"hidden",onChange:n=>{var a;console.log("click",n);const s=(a=n.currentTarget.files)==null?void 0:a[0];if(s){const o=new FileReader;o.onload=function(r){var c;const d=(c=r.target)==null?void 0:c.result;if(d){const u=JSON.parse(d),p=Object.keys(u).sort(),i=["groupsMap","groupsSort","selectedGroupId","allSpacesMap"];p.filter(l=>i.includes(l)).length===i.length?(L.setState(l=>({...l,...u})),A.set(u)):_.confirm({title:"Upload Error",content:"The file is not a valid backup file",onOk:()=>{}})}},o.readAsText(s)}}}),e.jsx(q,{label:"上传备份文件",children:e.jsx(F,{"aria-label":"Save",icon:e.jsx(N,{icon:"ic:round-upload-file",width:"24",height:"24"}),onClick:()=>{var n;(n=t.current)==null||n.click()}})})]})},V=t=>e.jsx(N,{inline:!0,icon:"mdi:github",width:"20",height:"20",className:"cursor-pointer",onClick:t.onClick}),$=()=>{var d,c,u;const[t,n]=g.useState(!1),{register:s,handleSubmit:a,watch:o,setValue:r}=T({defaultValues:{syncGistId:h.getSnapshot().syncGistId,token:h.getSnapshot().token,backupGistId:h.getSnapshot().backupGistId,githubUsername:(d=h.getSnapshot())==null?void 0:d.githubUsername,faviconSyncList:(c=h.getSnapshot())==null?void 0:c.faviconSyncList,deviceId:(u=k.getSnapshot())==null?void 0:u.deviceId}});return g.useEffect(()=>{const p=o((i,{name:l,type:f})=>{f==="change"&&(h.set({gistId:i.backupGistId,backupGistId:i.backupGistId,syncGistId:i.syncGistId,token:i.token,githubUsername:i.githubUsername,faviconSyncList:i.faviconSyncList}),k.set({deviceId:i.deviceId}))});return()=>p.unsubscribe()},[o]),e.jsx(U,{children:e.jsxs("div",{className:"m-12 max-w-lg",children:[e.jsx(m,{children:"GitHub Username"}),e.jsx(x,{...s("githubUsername"),className:"mb-6"}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{children:"Sync Gist ID"}),e.jsx(V,{onClick:()=>{window.open(`https://gist.github.com/${o("githubUsername")}/${o("syncGistId")}`,"_blank")}})]})}),e.jsx(x,{...s("syncGistId"),className:"mb-6"}),e.jsx(m,{children:"Gist Token"}),e.jsxs(P,{children:[e.jsx(x,{...s("token"),className:"mb-6",type:t?"text":"password"}),e.jsx(O,{width:"4.5rem",children:e.jsx(E,{h:"1.75rem",size:"sm",onClick:()=>{n(!t)},children:t?"Hide":"Show"})})]}),e.jsx(m,{children:"Device Id"}),e.jsx(x,{...s("deviceId"),className:"mb-6"}),e.jsx(m,{children:"Favicon Sync List"}),e.jsx(G,{...s("faviconSyncList"),className:"mb-6"}),e.jsx(m,{children:"Other Actions"}),e.jsx(M,{})]})})};function z(){const t=document.querySelector("#app-container");if(!t)throw new Error("Can not find #app-container");H(t).render(e.jsx($,{}))}z();
